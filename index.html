<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Card Deck Building App</title>
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <style>
    :root {
      --bg1: #0b0f1a;
      --bg2: #111827;
      --surface: #0c1322;
      --surface-2: #0f172a;
      --fg: #e8ecf1;
      --muted: #a6b0bf;
      --accent: #6ee7ff;
      --chip: rgba(255,255,255,0.08);
      --border: rgba(255,255,255,0.12);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      color: var(--fg);
      background: linear-gradient(180deg, var(--bg1), var(--bg2));
    }

    /* Top bar header */
    .site-header { background: var(--surface); border-bottom: 1px solid rgba(255,255,255,0.08); }
    .site-header .wrap { display:flex; align-items:center; justify-content:space-between; gap:16px; padding:16px 0; }
    .brand { margin:0; font-size:clamp(20px,3vw,28px); letter-spacing:0.2px; }

    /* Page container */
    .wrap { width:min(1100px, 92vw); margin-inline:auto; }
    main.wrap { padding:28px 0 60px; }

    /* Buttons */
    .btn { appearance:none; border:none; padding:12px 16px; border-radius:10px; font-weight:600; cursor:pointer; transition: transform 0.05s ease, background-color 0.2s ease, border-color 0.2s ease; }
    .btn:active { transform: translateY(1px) scale(0.99); }
    .btn-primary { background: var(--accent); color:#0b0f1a; }
    .btn-secondary { background: transparent; color: var(--fg); border:1px solid var(--border); }
    .btn-ghost { background: transparent; color: var(--muted); border:1px dashed var(--border); }

    .actions { display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-bottom:22px; }
    p { color: var(--muted); margin: 0 0 16px; }

    /* Filter section */
    .filters { background: var(--surface-2); border:1px solid var(--border); border-radius:14px; padding:16px; }
    .filters h2 { margin:0 0 12px; font-size:20px; }
    .filter-groups { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:16px; }
    .filter-group h3 { margin:0 0 8px; font-size:14px; color:var(--muted); font-weight:600; letter-spacing:0.2px; }

    .filter-row { display:flex; gap:8px; flex-wrap:wrap; }
    .filter-btn { background: transparent; color: var(--fg); border:1px solid var(--border); padding:8px 12px; border-radius:999px; font-weight:600; }
    .filter-btn[aria-pressed="true"], .filter-btn.is-active { background: var(--accent); color:#08101b; border-color: transparent; }

    .active-filters { margin-top:16px; display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
    .chip-row { display:flex; gap:8px; flex-wrap:wrap; }
    .chip { display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background: var(--chip); border:1px solid var(--border); font-size:13px; }
    .chip button { border:none; background:transparent; color:var(--muted); cursor:pointer; font-weight:700; line-height:1; }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="wrap">
      <h1 class="brand">Card Deck Building App</h1>
    </div>
  </header>

  <main class="wrap" role="main">
    <section class="actions" aria-label="Page actions">
      <button class="btn btn-primary" type="button" id="findDecksBtn">Find Decks</button>
      <button class="btn btn-secondary" type="button" id="uploadCardsBtn">Upload Cards</button>
    </section>

    <section class="filters" aria-labelledby="filter-heading">
      <h2 id="filter-heading">Filter</h2>

      <div class="filter-groups">
        <div class="filter-group" data-group="format">
          <h3>Format</h3>
          <div class="filter-row">
            <button class="filter-btn" type="button" data-filter-value="Standard" aria-pressed="false">Standard</button>
            <button class="filter-btn" type="button" data-filter-value="Modern" aria-pressed="false">Modern</button>
            <button class="filter-btn" type="button" data-filter-value="Pioneer" aria-pressed="false">Pioneer</button>
            <button class="filter-btn" type="button" data-filter-value="Commander/EDH" aria-pressed="false">Commander/EDH</button>
          </div>
        </div>

        <div class="filter-group" data-group="colors">
          <h3>Colors</h3>
          <div class="filter-row">
            <button class="filter-btn" type="button" data-filter-value="White" aria-pressed="false">White (W)</button>
            <button class="filter-btn" type="button" data-filter-value="Blue" aria-pressed="false">Blue (U)</button>
            <button class="filter-btn" type="button" data-filter-value="Black" aria-pressed="false">Black (B)</button>
            <button class="filter-btn" type="button" data-filter-value="Red" aria-pressed="false">Red (R)</button>
            <button class="filter-btn" type="button" data-filter-value="Green" aria-pressed="false">Green (G)</button>
            <button class="filter-btn" type="button" data-filter-value="Colorless" aria-pressed="false">Colorless (C)</button>
          </div>
        </div>

        <div class="filter-group" data-group="archetype">
          <h3>Archetype</h3>
          <div class="filter-row">
            <button class="filter-btn" type="button" data-filter-value="Aggro" aria-pressed="false">Aggro</button>
            <button class="filter-btn" type="button" data-filter-value="Control" aria-pressed="false">Control</button>
            <button class="filter-btn" type="button" data-filter-value="Midrange" aria-pressed="false">Midrange</button>
            <button class="filter-btn" type="button" data-filter-value="Combo" aria-pressed="false">Combo</button>
            <button class="filter-btn" type="button" data-filter-value="Tempo" aria-pressed="false">Tempo</button>
            <button class="filter-btn" type="button" data-filter-value="Ramp" aria-pressed="false">Ramp</button>
          </div>
        </div>
      </div>

      <div class="active-filters" aria-live="polite">
        <strong>Active filters:</strong>
        <div id="activeFilters" class="chip-row"></div>
        <button class="btn btn-ghost" id="clearFilters" type="button" hidden>Clear all</button>
      </div>
    </section>
  </main>

  <script>
    // --- No-op actions for now ---
    document.getElementById('findDecksBtn').addEventListener('click', () => console.log('Find Decks clicked (no action wired yet).'));
    document.getElementById('uploadCardsBtn').addEventListener('click', () => console.log('Upload Cards clicked (no action wired yet).'));

    // --- Filter state management ---
    // Map<group, Set<value>>
    const filterState = new Map();

    function getSet(group){
      if(!filterState.has(group)) filterState.set(group, new Set());
      return filterState.get(group);
    }

    function hasAnyFilters(){
      for (const [,set] of filterState) { if (set.size) return true; }
      return false;
    }

    function renderActiveFilters(){
      const container = document.getElementById('activeFilters');
      const clearBtn = document.getElementById('clearFilters');
      container.innerHTML = '';

      for (const [group, set] of filterState) {
        for (const val of set) {
          const chip = document.createElement('span');
          chip.className = 'chip';
          chip.dataset.group = group;
          chip.dataset.value = val;
          chip.innerHTML = `${group}: ${val} <button type="button" aria-label="Remove ${val} from ${group}">Ã—</button>`;
          container.appendChild(chip);
        }
      }

      clearBtn.hidden = !hasAnyFilters();
    }

    function toggleFilter(button){
      const group = button.closest('.filter-group').dataset.group;
      const value = button.dataset.filterValue;
      const set = getSet(group);

      if (set.has(value)) {
        set.delete(value);
        button.classList.remove('is-active');
        button.setAttribute('aria-pressed', 'false');
      } else {
        set.add(value);
        button.classList.add('is-active');
        button.setAttribute('aria-pressed', 'true');
      }

      renderActiveFilters();
      console.log('Current filters:', Object.fromEntries([...filterState].map(([g,s]) => [g, [...s]])));
    }

    // Wire up filter buttons
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => toggleFilter(btn));
    });

    // Remove via chip (event delegation)
    document.getElementById('activeFilters').addEventListener('click', (e) => {
      if (e.target.tagName.toLowerCase() !== 'button') return;
      const chip = e.target.closest('.chip');
      const { group, value } = chip.dataset;
      const set = getSet(group);
      if (set.has(value)) set.delete(value);

      // sync the corresponding button visual state
      const btn = document.querySelector(`.filter-group[data-group="${CSS.escape(group)}"] .filter-btn[data-filter-value="${CSS.escape(value)}"]`);
      if (btn) { btn.classList.remove('is-active'); btn.setAttribute('aria-pressed', 'false'); }

      renderActiveFilters();
      console.log('Removed filter via chip:', group, value);
    });

    // Clear all
    document.getElementById('clearFilters').addEventListener('click', () => {
      // reset state
      for (const [, set] of filterState) set.clear();
      // reset buttons
      document.querySelectorAll('.filter-btn').forEach(btn => { btn.classList.remove('is-active'); btn.setAttribute('aria-pressed','false'); });
      renderActiveFilters();
      console.log('Cleared all filters');
    });
  </script>
</body>
</html>
